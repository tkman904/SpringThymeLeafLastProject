<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<!-- Header -->
	<div id="header-wrapper">
		<header id="header" class="container">	
			<!-- Logo -->
			<div id="logo">
				<h1><a href="/">SFR</a></h1>
			</div>
	
			<!-- Nav -->
			<nav id="nav">
				<ul>
					<li class="current"><a href="/">Home</a></li>
					<li><a href="/member/join">회원가입</a></li>
					<li>
						<a href="#">맛집</a>
						<ul>
							<li><a href="/food/list">맛집 목록</a></li>
							<li><a href="/food/search">맛집 검색</a></li>
							<li><a href="/food/reserve">맛집 예약</a></li>
						</ul>
					</li>
					<li>
						<a href="#">레시피</a>
						<ul>
							<li><a href="/recipe/list">레시피 목록</a></li>
							<li><a href="/recipe/search">레시피 검색</a></li>
							<li><a href="/recipe/recommend">레시피 추천</a></li>
						</ul>
					</li>
					<li>
						<a href="#">서울 여행</a>
						<ul>
							<li><a href="/seoul/location">명소</a></li>
							<li><a href="/seoul/nature">자연&관광</a></li>
							<li><a href="/seoul/shop">쇼핑</a></li>
							<li><a href="/seoul/youtube">동영상</a></li>
						</ul>
					</li>
					<li>
						<a href="#">부산 여행</a>
						<ul>
							<li><a href="#">명소</a></li>
							<li><a href="#">자연&관광</a></li>
							<li><a href="#">축제</a></li>
							<li><a href="#">동영상</a></li>
						</ul>
					</li>
					<li><a href="/board/list">커뮤니티</a></li>
				</ul>
			</nav>
			<div class="row aln-right" th:if="${session.id == null}" @keyup.enter="login()">
				ID: <input type="text" ref="id" class="input-sm" size="15" v-model="id">&nbsp;
				PW: <input type="password" ref="pwd" class="input-sm" size="15" v-model="pwd">&nbsp;
				<button class="btn-xs btn-primary" type="button" @click="login()">로그인</button>
			</div>
			<div class="row aln-right" th:if="${session.id != null}">
				[[${session.name}]]님 로그인 되었습니다&nbsp;
				<button class="btn-xs btn-primary" type="button" @click="logout()">로그아웃</button>
			</div>
		</header>
	</div>
	<script>
		const logApp = Vue.createApp({
			data() {
				return {
					id: '',
					pwd: '',
					vo: {}
				}
			},
			methods: {
				// 로그인
				login() {
					// const id = ref("") => useState()
					if(this.id === "") {
						this.$refs.id.focus()
						return
					}
					if(this.pwd === "") {
						this.$refs.pwd.focus()
						return
					}
					axios.get('http://localhost/member/login_vue/', {
						params: {
							id: this.id,
							pwd: this.pwd
						}
					}).then(response=> {
						console.log(response.data)
						this.vo = response.data
						if(response.data.msg === 'OK') {
							location.href = "/"
						} else if(response.data.msg === 'NOID') {
							alert("아이디가 존재하지 않습니다")
							this.id = "";
							this.pwd = "";
							this.$refs.id.focus()
						} else if(response.data.msg === 'NOPWD') {
							alert("비밀번호가 틀렸습니다")
							this.pwd = "";
							this.$refs.pwd.focus()
						}
					})
				},
				// 로그아웃
				logout() {
					axios.get('http://localhost/member/logout_vue/')
					.then(response=> {
						if(response.data === 'yes') {
							location.href = "/"
						}
					})
				}
			}
		})
		logApp.config.compilerOptions.delimiters=['((','))']
    	logApp.mount("#header-wrapper")
	</script>
</body>
</html>